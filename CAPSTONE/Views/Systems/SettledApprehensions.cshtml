
@{
    ViewBag.Title = "Settled Apprehensions";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="row mt">
    <div class="col-lg-12">
        <div class="content-panel">
            <h4><i class="fa fa-angle-right"></i>Records of Settled Apprehensions</h4>
            <section id="">
                <table class="table table-bordered table-striped table-condensed cf" id="tbl_Impounded">
                    <thead class="cf">
                        <tr>
                            <th>Name</th>
                            <th>Violation</th>
                            <th>License No.</th>
                            <th>Plate No.</th>
                            <th>Vehicle Type</th>
                            <th>Date</th>

                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </section>
        </div>
    </div>
</div>


<script type="text/javascript">
    $('li a').removeClass("active");
    $('#tg-settled').addClass("active");

    $(document).ready(function () {
        $("#myModal_reload").modal({ backdrop: 'static', keyboard: false }, 'show');
        updateGrid();
        //$("#myModal_reload").modal("hide"); // remove when API is working
    });

    function updateGrid() {
        $.ajax({
            type: "POST",
            url: "/Systems/proc_get_setteled_apprehensions",
            dataType: "text",
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                data = someerm(data);

                var Json_Data = JSON.parse(data);
                console.log(Json_Data)
                for (var i = 0; i < Json_Data.length; i++) {
                    if (Json_Data[i]["isSettled"] == 1) {
                        var Row = `<tr><td class="Name" data-title="Name">` + Json_Data[i]["fname"] + `</td>
                                <td class="Address" data-title="Address">`+ Json_Data[i]["vdesc"] + `</td>
                                <td class="Address" data-title="Address">`+ Json_Data[i]["licenseno"] + `</td>
                                <td class="Address" data-title="Address">`+ Json_Data[i]["plateno"] + `</td>
                                <td class="Address" data-title="Address">`+ Json_Data[i]["vehicletype"] + `</td>
                                <td class="Address" data-title="Address">`+ Json_Data[i]["dateofapprehension"].split('T')[0] + `</td>`;
                        $('#tbl_Impounded tbody').append(Row);

                    }

                }
                $("#myModal_reload").modal("hide");
                $('#tbl_Impounded').DataTable();

            },
            error: function (textStatus, errorThrown) {
                // Success = false;//doesn't go here
                gritter("Error", "Error processing the request.");
            }
        });
    }
</script>



